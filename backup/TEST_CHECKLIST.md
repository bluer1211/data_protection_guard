# Data Protection Guard Plugin 測試檢查清單

## 日常測試指南

本檢查清單提供插件測試的完整指南，確保插件功能正常運作。

## 快速測試 (每日執行)

### 1. 基本功能測試
```bash
cd redmine/plugins/data_protection_guard
ruby quick_test.rb
```

**預期結果**: 所有測試通過，成功率 100%

### 2. 手動測試案例

#### 測試案例 1: 密碼偵測
**輸入內容**:
```
系統密碼: mypassword123
資料庫密碼: db_secret_456
```

**預期結果**: 偵測到密碼違規

#### 測試案例 2: 個人資料偵測
**輸入內容**:
```
客戶姓名: 張三豐
身分證號: A123456789
電子郵件: zhangsan@example.com
聯絡電話: 0912-345-678
```

**預期結果**: 偵測到個人資料違規

#### 測試案例 3: 混合內容偵測
**輸入內容**:
```
系統問題報告：
資料庫主機: 192.168.1.100
管理員密碼: admin123
客戶資訊: John Doe (john@example.com)
```

**預期結果**: 偵測到機敏資料和個人資料違規

## 完整測試 (每週執行)

### 1. 核心功能測試
```bash
ruby test_standalone.rb
```

**檢查項目**:
- [ ] 插件啟用狀態
- [ ] 機敏資料偵測功能
- [ ] 個人資料偵測功能
- [ ] 正則表達式驗證
- [ ] 錯誤訊息生成

### 2. 整合測試
```bash
ruby test_integration.rb
```

**檢查項目**:
- [ ] 真實世界使用場景
- [ ] 邊界情況處理
- [ ] 效能測試
- [ ] 配置變更測試

## 測試環境檢查

### 1. 檔案結構檢查
```bash
ls -la
```

**必要檔案**:
- [ ] `init.rb` - 插件初始化檔案
- [ ] `lib/data_protection_guard.rb` - 核心模組
- [ ] `test_standalone.rb` - 獨立測試腳本
- [ ] `test_integration.rb` - 整合測試腳本
- [ ] `quick_test.rb` - 快速測試腳本

### 2. 依賴檢查
```bash
ruby -c lib/data_protection_guard.rb
ruby -c test_standalone.rb
ruby -c test_integration.rb
ruby -c quick_test.rb
```

**預期結果**: 所有檔案語法正確

## 效能測試

### 1. 大量內容處理
**測試內容**: 10,000 字以上的文字內容
**預期結果**: 掃描時間 < 1 秒

### 2. 多個內容處理
**測試內容**: 100 個不同的內容
**預期結果**: 總處理時間 < 2 秒

## 配置測試

### 1. 啟用/禁用測試
- [ ] 禁用機敏資料偵測
- [ ] 禁用個人資料偵測
- [ ] 完全禁用插件
- [ ] 恢復所有設定

### 2. 正則表達式測試
- [ ] 測試有效的正則表達式模式
- [ ] 測試無效的正則表達式模式
- [ ] 測試邊界情況

## 錯誤處理測試

### 1. 異常輸入測試
- [ ] 空內容 (`""`)
- [ ] nil 內容 (`nil`)
- [ ] 特殊字符內容
- [ ] 超大內容 (> 1MB)

### 2. 錯誤訊息測試
- [ ] 機敏資料錯誤訊息
- [ ] 個人資料錯誤訊息
- [ ] 混合違規錯誤訊息

## 實際場景測試

### 1. 開發者場景
**模擬**: 開發者提交包含密碼的 Issue
**檢查**: 是否正確偵測並阻止提交

### 2. 客服場景
**模擬**: 客服人員記錄客戶資訊
**檢查**: 是否正確偵測個人資料

### 3. 系統管理員場景
**模擬**: 系統管理員提交配置檔案
**檢查**: 是否正確偵測機敏資料

## 問題排查

### 常見問題

#### 1. 測試失敗
**症狀**: 測試腳本執行失敗
**解決方案**:
- 檢查 Ruby 版本
- 檢查檔案權限
- 檢查檔案路徑

#### 2. 正則表達式問題
**症狀**: 預期的內容沒有被偵測到
**解決方案**:
- 檢查正則表達式模式
- 測試正則表達式有效性
- 調整測試案例

#### 3. 效能問題
**症狀**: 掃描速度過慢
**解決方案**:
- 檢查內容大小
- 優化正則表達式
- 檢查系統資源

### 調試技巧

#### 1. 啟用詳細輸出
```ruby
# 在測試腳本中添加
puts "Debug: #{content}"
puts "Violations: #{violations.inspect}"
```

#### 2. 測試單個正則表達式
```ruby
pattern = '\\b(?:password|pwd|passwd)\\s*[:=]\\s*[^\\s]+'
content = "密碼: secret123"
regex = Regexp.new(pattern, Regexp::IGNORECASE | Regexp::MULTILINE)
matches = content.scan(regex)
puts "Matches: #{matches}"
```

#### 3. 檢查設定
```ruby
puts "Settings: #{Setting.plugin_data_protection_guard.inspect}"
```

## 測試報告

### 測試結果記錄
- [ ] 測試日期
- [ ] 測試環境
- [ ] 測試結果
- [ ] 發現的問題
- [ ] 修復措施

### 測試統計
- [ ] 總測試數
- [ ] 通過測試數
- [ ] 失敗測試數
- [ ] 成功率

## 維護建議

### 1. 定期測試
- 每日執行快速測試
- 每週執行完整測試
- 每月執行效能測試

### 2. 更新測試案例
- 根據實際使用情況更新測試案例
- 添加新的邊界情況測試
- 優化正則表達式模式

### 3. 監控效能
- 記錄測試執行時間
- 監控記憶體使用
- 追蹤錯誤率

## 聯絡支援

如果遇到無法解決的問題，請：
1. 收集錯誤訊息和日誌
2. 記錄測試環境資訊
3. 提供重現步驟
4. 聯絡開發團隊
